---
// Page SSR Video 2
import GAConsentMode from '../components/GAConsentMode.astro';
---

<!DOCTYPE html>
<html lang="fr">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Vid√©o Exclusive - Syst√®me Souhaits R√©alis√©s</title>
    <meta name="description" content="D√©couvre cette vid√©o exclusive pour transformer ta vie" />
    <meta name="robots" content="noindex, nofollow" />
    <link rel="icon" type="image/svg+xml" href="/favicon.svg" />
    
    <!-- GA4 Consent Mode v2 -->
    <GAConsentMode />
    
    <!-- Start of Spiffy Checkout Popup Script -->
    <script>
    "use strict";!function(i,t){var f=t.spiffy=t.spiffy||[];if(!f.init){
    if(f.invoked)return void(t.console&&console.error&&console.warn("Spiffy Elements included twice."))
    ;f.invoked=!0,f.methods=["identify","config","debug","off","on"],f.factory=function(i){
    return function(){var t=Array.prototype.slice.call(arguments);return t.unshift(i),f.push(t),f}},
    f.methods.forEach(function(i){spiffy[i]=f.factory(i)}),f.load=function(t,f){if(!spiffy.ACCOUNT){
    spiffy.ACCOUNT=t,spiffy.DOMAIN=f;var e=i.createElement("script");e.type="text/javascript",
    e.async=!0,e.crossorigin="anonymous",e.src="https://js.static.spiffy.co/spiffy.js?a="+t
    ;var n=i.getElementsByTagName("script")[0];n.parentNode.insertBefore(e,n)}}}}(document,window),
    spiffy.SNIPPET_VERSION="1.1.0";
    spiffy.config({
        hideSidebar: false,
    })
    spiffy.load("sonnycourt");
    </script>
    <!-- End of Spiffy Checkout Popup Script -->
</head>
<body>
    <div class="video-page-container">
        <div class="animated-bg"></div>
        
        <div class="content-wrapper">
            <div class="container">
                <div class="header">
                    <h1>LE SECRET POUR R√âUSSIR SA VIE ET √äTRE HEUREUX</h1>
                    <p>√áa m'a pris PLUS DE 30 ANS pour r√©aliser ce que je vais te dire EN 10 MINUTES</p>
                </div>

                <div class="video-section">
                    <div class="video-container">
                        <video
                            id="videoPlayer"
                            class="video-player"
                            src="https://sonnycourt-videos-public.b-cdn.net/SEQUENCE%20SSR%20-%20C%CC%A7a%20m'a%20pris%20PLUS%20DE%2030%20ANS%20pour%20re%CC%81aliser%20ce%20que%20je%20vais%20te%20dire%C2%A0EN%C2%A010%C2%A0MINUTES.mp4"
                            preload="metadata"
                            playsinline
                            oncontextmenu="return false;"
                        >
                            Votre navigateur ne supporte pas la balise vid√©o.
                        </video>
                        
                        <!-- Overlay de play -->
                        <div class="play-overlay" id="playOverlay">
                            <button class="play-button" id="playButton">
                                <svg width="80" height="80" viewBox="0 0 80 80" fill="none">
                                    <circle cx="40" cy="40" r="40" fill="rgba(102, 51, 255, 0.9)"/>
                                    <polygon points="30,25 30,55 55,40" fill="white"/>
                                </svg>
                            </button>
                        </div>
                        
                        <!-- Contr√¥les personnalis√©s -->
                        <div class="video-controls">
                            <div class="volume-control">
                                <button class="control-btn volume-btn" id="volumeBtn" title="Volume">
                                    <svg width="18" height="18" viewBox="0 0 24 24" fill="currentColor">
                                        <path d="M3 9v6h4l5 5V4L7 9H3zm13.5 3c0-1.77-1.02-3.29-2.5-4.03v8.05c1.48-.74 2.5-2.26 2.5-4.02zM14 3.23v2.06c2.89.86 5 3.54 5 6.71s-2.11 5.85-5 6.71v2.06c4.01-.91 7-4.49 7-8.77s-2.99-7.86-7-8.77z"/>
                                    </svg>
                                </button>
                                <div class="volume-slider" id="volumeSlider">
                                    <input type="range" id="volumeRange" min="0" max="100" value="100" class="volume-range">
                                </div>
                            </div>
                            
                            <!-- Contr√¥le de vitesse -->
                            <div class="speed-control">
                                <button class="speed-button" id="speedButton" title="Vitesse">
                                    <svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
                                        <path d="M13 16a3 3 0 0 1 2.24 5"/>
                                        <path d="M18 12h.01"/>
                                        <path d="M18 21h-8a4 4 0 0 1-4-4 7 7 0 0 1 7-7h.2L9.6 6.4a1 1 0 1 1 2.8-2.8L15.8 7h.2c3.3 0 6 2.7 6 6v1a2 2 0 0 1-2 2h-1a3 3 0 0 0-3 3"/>
                                        <path d="M20 8.54V4a2 2 0 1 0-4 0v3"/>
                                        <path d="M7.612 12.524a3 3 0 1 0-1.6 4.3"/>
                                    </svg>
                                    <span id="speedDisplay">1x</span>
                                </button>
                                <div class="speed-menu" id="speedMenu">
                                    <div class="speed-option" data-speed="0.5">0.5x</div>
                                    <div class="speed-option" data-speed="0.75">0.75x</div>
                                    <div class="speed-option active" data-speed="1">1x</div>
                                    <div class="speed-option" data-speed="1.25">1.25x</div>
                                    <div class="speed-option" data-speed="1.5">1.5x</div>
                                    <div class="speed-option" data-speed="2">2x</div>
                                </div>
                            </div>
                            
                            <button class="control-btn fullscreen-btn" id="fullscreenBtn" title="Plein √©cran">
                                <svg width="18" height="18" viewBox="0 0 24 24" fill="currentColor">
                                    <path d="M7 14H5v5h5v-2H7v-3zm-2-4h2V7h3V5H5v5zm12 7h-3v2h5v-5h-2v3zM14 5v2h3v3h2V5h-5z"/>
                                </svg>
                            </button>
                        </div>
                    </div>

                    <div class="cta-container">
                        <a href="https://sonnycourt.spiffy.co/checkout/souhaits-realises#pop" class="cta-button" id="ctaButton">
                            Commencer Syst√®me Souhaits R√©alis√©s
                        </a>
                    </div>

                    <!-- Widget discret temps restant et places -->
                    <div class="info-widget" id="infoWidget" style="display: none;">
                        <div class="info-item">
                            <svg class="info-icon" width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                                <circle cx="12" cy="12" r="10"></circle>
                                <polyline points="12 6 12 12 16 14"></polyline>
                            </svg>
                            <div class="info-content">
                                <span class="info-label">Temps restant</span>
                                <div class="countdown-display">
                                    <span class="countdown-value" id="days">00</span>
                                    <span class="countdown-separator">:</span>
                                    <span class="countdown-value" id="hours">00</span>
                                    <span class="countdown-separator">:</span>
                                    <span class="countdown-value" id="minutes">00</span>
                                </div>
                            </div>
                        </div>
                        <div class="info-divider"></div>
                        <div class="info-item">
                            <svg class="info-icon" width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                                <rect x="3" y="4" width="18" height="18" rx="2" ry="2"></rect>
                                <line x1="16" y1="2" x2="16" y2="6"></line>
                                <line x1="8" y1="2" x2="8" y2="6"></line>
                                <line x1="3" y1="10" x2="21" y2="10"></line>
                            </svg>
                            <div class="info-content">
                                <span class="info-label">Places restantes</span>
                                <span class="info-value" id="placesRemaining">--</span>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, 'Helvetica Neue', Arial, sans-serif;
            color: #ffffff;
            margin: 0;
            padding: 0;
            overflow-x: hidden;
        }

        .video-page-container {
            min-height: 100vh;
            position: relative;
            background: #0a0014;
        }

        .animated-bg {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: linear-gradient(
                135deg, 
                #0a0014 0%, 
                #1a0033 20%, 
                #2d1b69 40%, 
                #1a0033 60%, 
                #0a0014 80%, 
                #000033 100%
            );
            background-size: 600% 600%;
            animation: gradientWave 12s ease infinite;
            z-index: -1;
        }

        @keyframes gradientWave {
            0%, 100% { background-position: 0% 50%; }
            25% { background-position: 50% 100%; }
            50% { background-position: 100% 50%; }
            75% { background-position: 50% 0%; }
        }

        .content-wrapper {
            position: relative;
            z-index: 1;
            padding: 80px 20px 60px;
            min-height: 100vh;
            display: flex;
            align-items: center;
            justify-content: center;
        }

        .container {
            max-width: 900px;
            width: 100%;
            text-align: center;
            animation: fadeIn 1s ease-out;
        }

        @keyframes fadeIn {
            from {
                opacity: 0;
                transform: translateY(20px);
            }
            to {
                opacity: 1;
                transform: translateY(0);
            }
        }

        .header {
            margin-bottom: 40px;
        }

        .header h1 {
            font-size: 48px;
            font-weight: 800;
            margin-bottom: 20px;
            line-height: 1.2;
            letter-spacing: -0.02em;
            background: linear-gradient(135deg, #a78bfa 0%, #8b5cf6 50%, #6366f1 100%);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            background-clip: text;
            text-shadow: 0 0 40px rgba(139, 92, 246, 0.3);
            position: relative;
            animation: titleGlow 3s ease-in-out infinite;
        }

        @keyframes titleGlow {
            0%, 100% {
                filter: brightness(1);
            }
            50% {
                filter: brightness(1.1);
            }
        }

        .header p {
            font-size: 18px;
            color: rgba(255, 255, 255, 0.9);
            line-height: 1.6;
        }

        /* Widget info discret */
        .info-widget {
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 24px;
            margin: 30px auto 0;
            padding: 20px 32px;
            background: linear-gradient(135deg, rgba(20, 20, 22, 0.95) 0%, rgba(30, 20, 45, 0.9) 100%);
            backdrop-filter: blur(15px);
            border-radius: 16px;
            border: 1px solid rgba(102, 51, 255, 0.3);
            max-width: 700px;
            animation: fadeIn 0.8s ease-out;
            box-shadow: 0 8px 32px rgba(0, 0, 0, 0.4);
        }

        .info-item {
            display: flex;
            align-items: center;
            gap: 12px;
        }

        .info-icon {
            width: 18px;
            height: 18px;
            color: rgba(102, 51, 255, 0.9);
            flex-shrink: 0;
        }

        .info-content {
            display: flex;
            flex-direction: column;
            gap: 4px;
        }

        .info-label {
            font-size: 11px;
            color: rgba(255, 255, 255, 0.6);
            text-transform: uppercase;
            letter-spacing: 0.5px;
            font-weight: 600;
        }

        .info-value {
            font-weight: 700;
            color: #ffffff;
            font-size: 16px;
        }

        #placesRemaining {
            color: #ef4444;
            font-weight: 700;
            font-size: 18px;
        }

        /* Countdown display */
        .countdown-display {
            display: flex;
            align-items: baseline;
            gap: 4px;
        }

        .countdown-value {
            font-size: 20px;
            font-weight: 700;
            color: #ffffff;
            font-variant-numeric: tabular-nums;
            min-width: 28px;
            text-align: center;
        }

        .countdown-separator {
            font-size: 16px;
            color: rgba(102, 51, 255, 0.6);
            font-weight: 600;
            margin: 0 2px;
        }

        .info-divider {
            width: 1px;
            height: 40px;
            background: rgba(102, 51, 255, 0.2);
        }

        .video-section {
            margin-top: 40px;
        }

        .video-container {
            position: relative;
            width: 100%;
            border-radius: 16px;
            overflow: hidden;
            box-shadow: 0 20px 60px rgba(0, 0, 0, 0.5);
            background: #000;
            margin-bottom: 40px;
        }

        .video-player {
            width: 100%;
            height: auto;
            display: block;
            -webkit-user-select: none;
            -moz-user-select: none;
            -ms-user-select: none;
            user-select: none;
            -webkit-touch-callout: none;
            cursor: pointer;
        }

        /* Masquer les contr√¥les natifs */
        .video-player::-webkit-media-controls {
            display: none !important;
        }
        .video-player::-webkit-media-controls-panel {
            display: none !important;
        }
        .video-player::-webkit-media-controls-play-button {
            display: none !important;
        }
        .video-player::-webkit-media-controls-timeline {
            display: none !important;
        }
        .video-player::-webkit-media-controls-current-time-display {
            display: none !important;
        }
        .video-player::-webkit-media-controls-time-remaining-display {
            display: none !important;
        }
        .video-player::-webkit-media-controls-mute-button {
            display: none !important;
        }
        .video-player::-webkit-media-controls-volume-slider {
            display: none !important;
        }
        .video-player::-webkit-media-controls-fullscreen-button {
            display: none !important;
        }

        /* Overlay de play */
        .play-overlay {
            position: absolute;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(0, 0, 0, 0.7);
            display: flex;
            align-items: center;
            justify-content: center;
            z-index: 10;
            transition: opacity 0.3s ease;
        }

        .play-overlay.hidden {
            opacity: 0;
            pointer-events: none;
        }

        .play-button {
            background: none;
            border: none;
            cursor: pointer;
            transition: transform 0.3s ease;
            pointer-events: all;
        }

        .play-button:hover {
            transform: scale(1.1);
        }

        .play-button svg {
            filter: drop-shadow(0 4px 8px rgba(0, 0, 0, 0.3));
        }

        /* Contr√¥les personnalis√©s */
        .video-controls {
            position: absolute;
            bottom: 20px;
            right: 20px;
            display: flex;
            gap: 8px;
            z-index: 20;
            opacity: 0;
            transition: all 0.4s cubic-bezier(0.4, 0, 0.2, 1);
            transform: translateY(10px);
        }

        .video-container:hover .video-controls {
            opacity: 1;
            transform: translateY(0);
        }

        .control-btn {
            background: rgba(0, 0, 0, 0.85);
            border: none;
            border-radius: 50%;
            width: 40px;
            height: 40px;
            display: flex;
            align-items: center;
            justify-content: center;
            cursor: pointer;
            transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);
            color: rgba(255, 255, 255, 0.9);
            backdrop-filter: blur(10px);
            box-shadow: 0 4px 12px rgba(0, 0, 0, 0.3);
        }

        .control-btn:hover {
            background: rgba(0, 0, 0, 0.95);
            color: white;
            transform: scale(1.1);
            box-shadow: 0 6px 20px rgba(0, 0, 0, 0.4);
        }

        .control-btn svg {
            width: 18px;
            height: 18px;
            transition: all 0.2s ease;
        }

        /* Contr√¥le du volume */
        .volume-control {
            position: relative;
            display: flex;
            align-items: center;
        }

        .volume-slider {
            position: absolute;
            bottom: 50px;
            right: 0;
            background: rgba(0, 0, 0, 0.9);
            border-radius: 12px;
            padding: 20px 15px;
            opacity: 0;
            visibility: hidden;
            transition: all 0.4s cubic-bezier(0.4, 0, 0.2, 1);
            transform: translateY(15px) scale(0.9);
            backdrop-filter: blur(15px);
            box-shadow: 0 8px 32px rgba(0, 0, 0, 0.4);
        }

        .volume-control:hover .volume-slider,
        .volume-slider:hover {
            opacity: 1;
            visibility: visible;
            transform: translateY(0) scale(1);
        }

        .volume-range {
            -webkit-appearance: none;
            appearance: none;
            width: 100px;
            height: 6px;
            background: rgba(255, 255, 255, 0.2);
            border-radius: 3px;
            outline: none;
            cursor: pointer;
            transition: all 0.2s ease;
        }

        .volume-range:hover {
            background: rgba(255, 255, 255, 0.3);
        }

        .volume-range::-webkit-slider-thumb {
            -webkit-appearance: none;
            appearance: none;
            width: 18px;
            height: 18px;
            background: #6633ff;
            border-radius: 50%;
            cursor: pointer;
            box-shadow: 0 4px 12px rgba(102, 51, 255, 0.4);
            transition: all 0.2s ease;
            border: 2px solid rgba(255, 255, 255, 0.9);
        }

        .volume-range::-webkit-slider-thumb:hover {
            transform: scale(1.2);
            box-shadow: 0 6px 20px rgba(102, 51, 255, 0.6);
        }

        .volume-range::-moz-range-thumb {
            width: 18px;
            height: 18px;
            background: #6633ff;
            border-radius: 50%;
            cursor: pointer;
            border: 2px solid rgba(255, 255, 255, 0.9);
            box-shadow: 0 4px 12px rgba(102, 51, 255, 0.4);
        }

        .volume-range::-webkit-slider-track {
            background: rgba(255, 255, 255, 0.2);
            border-radius: 3px;
            height: 6px;
        }

        .volume-range::-moz-range-track {
            background: rgba(255, 255, 255, 0.2);
            border-radius: 3px;
            height: 6px;
        }

        /* Contr√¥le de vitesse */
        .speed-control {
            position: relative;
        }

        .speed-button {
            background: rgba(0, 0, 0, 0.85);
            border: 2px solid rgba(102, 51, 255, 0.5);
            border-radius: 8px;
            color: white;
            padding: 8px 12px;
            font-size: 0.9rem;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.3s ease;
            backdrop-filter: blur(10px);
            display: flex;
            align-items: center;
            gap: 6px;
            box-shadow: 0 4px 12px rgba(0, 0, 0, 0.3);
        }

        .speed-button:hover {
            background: rgba(0, 0, 0, 0.95);
            border-color: rgba(102, 51, 255, 0.8);
            transform: scale(1.05);
        }

        .speed-button svg {
            width: 16px;
            height: 16px;
        }

        .speed-menu {
            position: absolute;
            bottom: 100%;
            right: 0;
            margin-bottom: 8px;
            background: rgba(0, 0, 0, 0.95);
            border: 2px solid rgba(102, 51, 255, 0.5);
            border-radius: 8px;
            padding: 8px 0;
            min-width: 100px;
            display: none;
            backdrop-filter: blur(10px);
            box-shadow: 0 10px 40px rgba(0, 0, 0, 0.5);
        }

        .speed-menu.active {
            display: block;
        }

        .speed-option {
            padding: 10px 16px;
            color: white;
            cursor: pointer;
            transition: all 0.2s ease;
            font-size: 0.9rem;
            display: flex;
            align-items: center;
            justify-content: space-between;
        }

        .speed-option:hover {
            background: rgba(102, 51, 255, 0.2);
        }

        .speed-option.active {
            background: rgba(102, 51, 255, 0.3);
            color: #ffffff;
        }

        .cta-container {
            margin-top: 40px;
        }

        .cta-button {
            display: inline-block;
            padding: 18px 40px;
            background: linear-gradient(135deg, #6633ff 0%, #9933ff 100%);
            color: #ffffff;
            text-decoration: none;
            border-radius: 50px;
            font-size: 18px;
            font-weight: 600;
            transition: all 0.3s ease;
            box-shadow: 0 8px 30px rgba(102, 51, 255, 0.4);
            letter-spacing: 0.5px;
        }

        .cta-button:hover {
            transform: translateY(-2px);
            box-shadow: 0 12px 40px rgba(102, 51, 255, 0.6);
            background: linear-gradient(135deg, #7a3fff 0%, #aa3fff 100%);
        }

        .cta-button:active {
            transform: translateY(0);
        }

        .cta-button.disabled {
            background: linear-gradient(135deg, #4a4a4a 0%, #2a2a2a 100%);
            color: rgba(255, 255, 255, 0.5);
            cursor: not-allowed;
            pointer-events: none;
            box-shadow: 0 4px 15px rgba(0, 0, 0, 0.3);
            opacity: 0.6;
        }

        .cta-button.disabled:hover {
            transform: none;
            box-shadow: 0 4px 15px rgba(0, 0, 0, 0.3);
            background: linear-gradient(135deg, #4a4a4a 0%, #2a2a2a 100%);
        }

        /* Mobile */
        @media (max-width: 768px) {
            .content-wrapper {
                padding: 40px 15px 40px;
            }

            .header {
                margin-bottom: 30px;
            }

            .header h1 {
                font-size: 32px;
                line-height: 1.3;
                margin-bottom: 12px;
            }

            .header p {
                font-size: 16px;
            }

            .cta-button {
                padding: 16px 32px;
                font-size: 16px;
            }
        }

        /* Masquer header et footer */
        header, .site-header, #header, .elementor-header, .ast-header, .fl-page-header,
        footer, .site-footer, #footer, .elementor-footer, .ast-footer, .fl-page-footer {
            display: none !important;
        }
    </style>

    <script is:inline>
        (function() {
            // ===== V√âRIFICATION ET PR√âSERVATION DU TOKEN =====
            const urlParams = new URLSearchParams(window.location.search);
            const previewParam = urlParams.get('preview');
            const isPreviewMode = previewParam === 'true';
            const isPreviewExpired = previewParam === 'expired';
            
            const tokenFromUrl = urlParams.get('token');
            const storedToken = localStorage.getItem('ssr_token');
            const token = tokenFromUrl || storedToken;

            // Mode preview : permettre l'acc√®s sans token
            if (isPreviewMode || isPreviewExpired) {
                console.log('üîç Mode PREVIEW activ√© - acc√®s sans token', isPreviewExpired ? '(expired)' : '');
            } else {
                // Si pas de token et pas en mode preview, rediriger vers la page d'inscription
                if (!token) {
                    window.location.href = '/ssr-inscription';
                    return;
                }

                // Stocker le token dans localStorage et cookie
                if (token) {
                    localStorage.setItem('ssr_token', token);
                    document.cookie = `ssr_token=${token}; path=/; max-age=${7 * 24 * 60 * 60}; SameSite=Lax`;
                }
            }

            // Le bouton CTA pointe vers le checkout Spiffy en popup
            // Le script Spiffy g√®re automatiquement l'ouverture en popup gr√¢ce au #pop dans l'URL

            // ===== R√âCUP√âRATION ET AFFICHAGE DES DONN√âES DYNAMIQUES =====
            async function loadSSRData() {
                const infoWidget = document.getElementById('infoWidget');
                
                // Mode preview expired : simuler l'√©tat expir√©
                if (isPreviewExpired) {
                    if (infoWidget) {
                        infoWidget.style.display = 'flex';
                    }
                    const placesEl = document.getElementById('placesRemaining');
                    if (placesEl) {
                        placesEl.textContent = '0';
                    }
                    
                    // Afficher le countdown √† z√©ro
                    const daysEl = document.getElementById('days');
                    const hoursEl = document.getElementById('hours');
                    const minutesEl = document.getElementById('minutes');
                    if (daysEl && hoursEl && minutesEl) {
                        daysEl.textContent = '00';
                        hoursEl.textContent = '00';
                        minutesEl.textContent = '00';
                    }
                    
                    // D√©sactiver imm√©diatement le bouton CTA
                    const ctaButton = document.getElementById('ctaButton');
                    if (ctaButton) {
                        ctaButton.classList.add('disabled');
                        ctaButton.removeAttribute('href');
                        ctaButton.style.pointerEvents = 'none';
                        ctaButton.style.cursor = 'not-allowed';
                    }
                    
                    console.log('üîç Mode PREVIEW EXPIRED - countdown √† z√©ro, bouton d√©sactiv√©');
                    return;
                }
                
                // Mode preview : afficher des donn√©es de d√©mo avec countdown anim√©
                if (isPreviewMode) {
                    if (infoWidget) {
                        infoWidget.style.display = 'flex';
                    }
                    const placesEl = document.getElementById('placesRemaining');
                    if (placesEl) {
                        placesEl.textContent = '45 / 300';
                    }
                    // Simuler un countdown qui se met √† jour
                    const daysEl = document.getElementById('days');
                    const hoursEl = document.getElementById('hours');
                    const minutesEl = document.getElementById('minutes');
                    if (daysEl && hoursEl && minutesEl) {
                        // Simuler 5 jours, 12 heures, 30 minutes
                        let totalSeconds = 5 * 86400 + 12 * 3600 + 30 * 60;
                        
                        function updatePreviewCountdown() {
                            const ctaButton = document.getElementById('ctaButton');
                            
                            if (totalSeconds <= 0) {
                                daysEl.textContent = '00';
                                hoursEl.textContent = '00';
                                minutesEl.textContent = '00';
                                
                                // D√©sactiver le bouton CTA
                                if (ctaButton) {
                                    ctaButton.classList.add('disabled');
                                    ctaButton.removeAttribute('href');
                                    ctaButton.style.pointerEvents = 'none';
                                    ctaButton.style.cursor = 'not-allowed';
                                }
                                return;
                            }
                            
                            const days = Math.floor(totalSeconds / 86400);
                            const hours = Math.floor((totalSeconds % 86400) / 3600);
                            const minutes = Math.floor((totalSeconds % 3600) / 60);
                            
                            daysEl.textContent = String(days).padStart(2, '0');
                            hoursEl.textContent = String(hours).padStart(2, '0');
                            minutesEl.textContent = String(minutes).padStart(2, '0');
                            
                            totalSeconds--;
                        }
                        
                        updatePreviewCountdown();
                        setInterval(updatePreviewCountdown, 1000);
                    }
                    return;
                }

                // Si pas de token, ne pas afficher le widget
                if (!token) {
                    return;
                }

                try {
                    const response = await fetch(`/.netlify/functions/check-ssr-access?token=${encodeURIComponent(token)}`);
                    const data = await response.json();

                    if (!data.valid) {
                        console.log('Token invalide pour affichage des donn√©es');
                        return;
                    }

                    // Afficher le widget (d√©j√† r√©cup√©r√© plus haut)
                    if (infoWidget) {
                        infoWidget.style.display = 'flex';
                    }

                    // Afficher les places
                    const placesEl = document.getElementById('placesRemaining');
                    if (placesEl) {
                        if (data.isExpired) {
                            placesEl.textContent = '0';
                        } else if (data.isSoldOut && !data.isReopened) {
                            placesEl.textContent = '0';
                        } else if (data.isReopened) {
                            placesEl.textContent = `${data.places} (r√©ouverture)`;
                        } else {
                            placesEl.textContent = `${data.places} / 300`;
                        }
                    }

                    // Afficher et mettre √† jour le countdown en temps r√©el
                    const daysEl = document.getElementById('days');
                    const hoursEl = document.getElementById('hours');
                    const minutesEl = document.getElementById('minutes');
                    
                    if (daysEl && hoursEl && minutesEl) {
                        // Utiliser timeRemaining de l'API ou calculer depuis startTime
                        let timeRemainingSeconds = data.timeRemaining;
                        const startTime = data.startTime;
                        const TOTAL_COUNTDOWN_SECONDS = 16 * 24 * 60 * 60; // 16 jours en secondes
                        
                        function updateCountdown() {
                            // Recalculer le temps restant en temps r√©el depuis startTime
                            const now = Math.floor(Date.now() / 1000);
                            const secondsElapsed = now - startTime;
                            const timeRemaining = Math.max(0, TOTAL_COUNTDOWN_SECONDS - secondsElapsed);
                            
                            const ctaButton = document.getElementById('ctaButton');
                            
                            if (timeRemaining <= 0) {
                                daysEl.textContent = '00';
                                hoursEl.textContent = '00';
                                minutesEl.textContent = '00';
                                
                                // D√©sactiver le bouton CTA
                                if (ctaButton) {
                                    ctaButton.classList.add('disabled');
                                    ctaButton.removeAttribute('href');
                                    ctaButton.style.pointerEvents = 'none';
                                    ctaButton.style.cursor = 'not-allowed';
                                }
                                return;
                            }
                            
                            const days = Math.floor(timeRemaining / 86400);
                            const hours = Math.floor((timeRemaining % 86400) / 3600);
                            const minutes = Math.floor((timeRemaining % 3600) / 60);
                            
                            daysEl.textContent = String(days).padStart(2, '0');
                            hoursEl.textContent = String(hours).padStart(2, '0');
                            minutesEl.textContent = String(minutes).padStart(2, '0');
                        }

                        // Mise √† jour initiale
                        updateCountdown();
                        
                        // V√©rifier imm√©diatement si le countdown est d√©j√† √† z√©ro
                        const now = Math.floor(Date.now() / 1000);
                        const secondsElapsed = now - startTime;
                        const timeRemaining = Math.max(0, TOTAL_COUNTDOWN_SECONDS - secondsElapsed);
                        if (timeRemaining <= 0) {
                            const ctaButton = document.getElementById('ctaButton');
                            if (ctaButton) {
                                ctaButton.classList.add('disabled');
                                ctaButton.removeAttribute('href');
                                ctaButton.style.pointerEvents = 'none';
                                ctaButton.style.cursor = 'not-allowed';
                            }
                        }

                        // Mettre √† jour toutes les secondes pour un countdown en temps r√©el
                        setInterval(updateCountdown, 1000);
                    }

                } catch (error) {
                    console.error('Erreur lors du chargement des donn√©es SSR:', error);
                }
            }

            // Charger les donn√©es apr√®s le chargement de la page
            function initSSRData() {
                console.log('üîç Initialisation SSR Data - Preview:', isPreviewMode, 'Token:', token ? 'pr√©sent' : 'absent');
                loadSSRData();
            }

            if (document.readyState === 'loading') {
                document.addEventListener('DOMContentLoaded', initSSRData);
            } else {
                // Attendre un peu pour s'assurer que le DOM est pr√™t
                setTimeout(initSSRData, 100);
            }

            // Protection contre le t√©l√©chargement et la copie
            document.addEventListener('contextmenu', function(e) {
                e.preventDefault();
                return false;
            });

            document.addEventListener('keydown', function(e) {
                // Ctrl+S, Cmd+S, F12, Ctrl+Shift+I, Cmd+Option+I
                if ((e.ctrlKey || e.metaKey) && e.key === 's') {
                    e.preventDefault();
                    return false;
                }
                if (e.key === 'F12' || 
                    ((e.ctrlKey || e.metaKey) && e.shiftKey && e.key === 'I')) {
                    e.preventDefault();
                    return false;
                }
            });

            // ===== GESTION DU PLAYER VID√âO =====
            const videoPlayer = document.getElementById('videoPlayer');
            const playButton = document.getElementById('playButton');
            const playOverlay = document.getElementById('playOverlay');
            const volumeBtn = document.getElementById('volumeBtn');
            const volumeRange = document.getElementById('volumeRange');
            const fullscreenBtn = document.getElementById('fullscreenBtn');
            const speedButton = document.getElementById('speedButton');
            const speedMenu = document.getElementById('speedMenu');
            const speedDisplay = document.getElementById('speedDisplay');
            const speedOptions = document.querySelectorAll('.speed-option');

            // Initialiser le volume
            if (videoPlayer && volumeRange) {
                videoPlayer.volume = 1;
                volumeRange.value = 100;
            }

            // Play/Pause
            if (playButton) {
                playButton.addEventListener('click', () => {
                    if (videoPlayer) {
                        videoPlayer.play();
                        playOverlay.classList.add('hidden');
                    }
                });
            }

            // Clic sur la vid√©o pour play/pause
            if (videoPlayer) {
                videoPlayer.addEventListener('click', () => {
                    if (videoPlayer.paused) {
                        videoPlayer.play();
                        playOverlay.classList.add('hidden');
                    } else {
                        videoPlayer.pause();
                        playOverlay.classList.remove('hidden');
                    }
                });

                // Afficher l'overlay quand la vid√©o est en pause
                videoPlayer.addEventListener('pause', () => {
                    playOverlay.classList.remove('hidden');
                });

                videoPlayer.addEventListener('play', () => {
                    playOverlay.classList.add('hidden');
                });
            }

            // Contr√¥le du volume
            if (volumeRange) {
                volumeRange.addEventListener('input', (e) => {
                    const volume = e.target.value / 100;
                    if (videoPlayer) {
                        videoPlayer.volume = volume;
                    }
                });
            }

            // Contr√¥le de vitesse
            if (speedButton && speedMenu) {
                speedButton.addEventListener('click', (e) => {
                    e.stopPropagation();
                    speedMenu.classList.toggle('active');
                });

                // Fermer le menu si on clique ailleurs
                document.addEventListener('click', (e) => {
                    if (!speedButton.contains(e.target) && !speedMenu.contains(e.target)) {
                        speedMenu.classList.remove('active');
                    }
                });

                // G√©rer la s√©lection de vitesse
                speedOptions.forEach(option => {
                    option.addEventListener('click', () => {
                        const speed = parseFloat(option.dataset.speed);
                        if (videoPlayer) {
                            videoPlayer.playbackRate = speed;
                        }
                        if (speedDisplay) {
                            speedDisplay.textContent = speed + 'x';
                        }
                        
                        // Mettre √† jour l'option active
                        speedOptions.forEach(opt => opt.classList.remove('active'));
                        option.classList.add('active');
                        
                        // Fermer le menu
                        speedMenu.classList.remove('active');
                    });
                });
            }

            // Plein √©cran
            if (fullscreenBtn) {
                // D√©tecter si on est sur mobile
                const isMobile = /Android|webOS|iPhone|iPad|iPod|BlackBerry|IEMobile|Opera Mini/i.test(navigator.userAgent);
                
                if (isMobile) {
                    fullscreenBtn.style.display = 'none';
                } else {
                    fullscreenBtn.addEventListener('click', () => {
                        if (document.fullscreenElement) {
                            document.exitFullscreen();
                        } else if (videoPlayer) {
                            videoPlayer.requestFullscreen().catch(err => {
                                console.log('Erreur plein √©cran:', err);
                            });
                        }
                    });
                }
            }
        })();
    </script>
</body>
</html>

